(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{172:function(e,t,a){e.exports=a(315)},315:function(e,t,a){"use strict";a.r(t);var r={};a.r(r),a.d(r,"map",function(){return v});var n=a(0),o=a.n(n),i=a(33),l=a.n(i),c=a(49),s=a(35),u=a(149),d=a(162),p=a(36),y=a(20),b="FETCH_MAP_DATA",m="FETCH_MAP_DATA_SUCCESS",f="FETCH_MAP_DATA_ERROR",h={currentData:null,calculatedData:null,dataFetching:!1,dataFetchingError:{}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case b:return Object(y.a)({},e,{dataFetching:!0});case m:return Object(y.a)({},e,{dataFetching:!1,currentData:Object(p.a)(t.payload)});case f:return Object(y.a)({},e,{dataFetching:!1,currentData:{},dataFetchingError:t.payload});case"CALCULATE_DATA_SUCCESS":return Object(y.a)({},e,{calculatedData:t.payload});default:return e}},x=a(47),g=a(48),w=a(79),j=a(75),O=a(74),_=a(78),k=a(161),S=a(73),A=a(106),E=a.n(A),C=a(99),D=function(e,t){return{type:"FeatureCollection",color:e,features:[{type:"Feature",geometry:{type:t,coordinates:[]}}]}},L=function(e,t,a){var r=e.toString(16),n=t.toString(16),o=a.toString(16);return 1===r.length&&(r="0"+r),1===n.length&&(n="0"+n),1===o.length&&(o="0"+o),"#"+r+n+o},F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LineString";if(e&&Object.keys(e).length){var a=function(e){var t=C.cloneDeep(e);return Object.keys(t).reduce(function(e,a){var r=t[a],n=r.x,o=r.y,i=r.z,l=Math.sqrt(Math.pow(n,2)+Math.pow(o,2)+Math.pow(i,2)),c=Object(S.a)({},a,l);return Object(y.a)({},e,c)},{})}(e),r=function(e){var t=e[Object.keys(e)[0]];return Object.keys(e).reduce(function(t,a){return{maxValue:e[a]>t.maxValue?e[a]:t.maxValue,minValue:e[a]<t.minValue?e[a]:t.minValue}},{maxValue:0,minValue:t})}(a),n=function(e,t){return e.reduce(function(a,r){var n,o=r.color,i=a.keyNumber+1,l=parseFloat(r.coords[0]),c=parseFloat(r.coords[1]),s=[l,c],u=e[i];if(n=u?[parseFloat(u.coords[0]),parseFloat(u.coords[1])]:[l,c],"MultiPoint"===t){var d=a.data.findIndex(function(e,t){return e.color===o&&t!==a.keyNumber});if(-1!==d)return a.data[d].features[0].geometry.coordinates.push([].concat(s)),{data:a.data};var p=D(o,t);return p.features[0].geometry.coordinates.push([].concat(s)),a.data.push(p),{data:a.data,keyNumber:a.keyNumber+1}}var y=D(o,t);y.features[0].geometry.coordinates.push(s,n);var b=a.data;return b.push(y),{data:b,keyNumber:i}},{keyNumber:0,data:[]})}(function(e){var t=new E.a,a=new E.a;return e.map(function(e){var r=e.coords,n=t.filter(parseFloat(r[0])),o=a.filter(parseFloat(r[1]));return Object(y.a)({},e,{coords:[n,o]})})}(function(e,t,a){return Object.keys(a).map(function(r){var n=(a[r]-t)/(e-t);t===e&&(n=.5);var o=Math.ceil(255*n),i=Math.ceil(255-o);return{coords:r.split(","),color:L(o,i,0),weight:n}})}(r.maxValue,r.minValue,a)),t);return{coords:Object(p.a)(n.data),shape:t}}return{coords:[],shape:t}},M=a(99),U=a.n(M),T=a(60),$=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(w.a)(this,Object(j.a)(t).call(this,e))).state={viewport:{width:1250,height:900,zoom:8}},a.showData=a.showData.bind(Object(O.a)(a)),a}return Object(_.a)(t,e),Object(g.a)(t,[{key:"componentWillMount",value:function(){(0,this.props.getRecords)(),this.locateUser()}},{key:"locateUser",value:function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){e.setState(Object(y.a)({},e.state,{viewport:Object(y.a)({},e.state.viewport,{latitude:t.coords.latitude,longitude:t.coords.longitude,zoom:10})}))})}},{key:"showData",value:function(){var e=this.props.calculatedData;if(!e)return Object(y.a)({},T);var t=e.coords.reduce(function(e,t){var a=e.id,r=e.sources,n=e.layers,o=t.color;return{sources:[].concat(Object(p.a)(r),[{type:"geojson",data:Object(y.a)({},t)}]),layers:[].concat(Object(p.a)(n),[{id:""+a,type:"line",source:""+a,paint:{"line-color":o,"line-width":10}}]),id:a+1}},{sources:[],layers:[],id:0}),a=t.sources,r=t.layers,n=T.layers,o=T.sources;return Object(y.a)({},T,{layers:[].concat(Object(p.a)(n),Object(p.a)(r)),sources:Object(y.a)({},o,a)})}},{key:"render",value:function(){var e=this,t=this.state.viewport;return o.a.createElement("div",null,o.a.createElement(k.a,Object.assign({width:"100%",height:"100%"},t,{mapStyle:this.showData(),onViewportChange:function(t){return e.setState({viewport:t})}})))}}]),t}(n.Component),z=Object(c.b)(function(e){var t=e.map;return Object(y.a)({},t)},function(e){return{getRecords:function(t){return e(function(e){return{type:b,payload:e}}(t))}}})($),P=a(319),R=a(320),V={marginTop:"2px",cursor:"pointer",backgroundColor:"#def05b"},N=function(e){var t=e.created,a=e.calculateData;return o.a.createElement(R.a.Item,{style:V,onClick:a},o.a.createElement(R.a.Content,null,o.a.createElement(R.a.Item,{as:"a"},t)))},B=function(e){function t(){return Object(x.a)(this,t),Object(w.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentData,a=e.calculateData;return o.a.createElement(P.a,null,o.a.createElement(R.a,{divided:!0,relaxed:!0,style:{position:"absolute",top:20,right:35,backgroundColor:"white",width:"15%",height:"15%",overflow:"auto"}},t?t.map(function(e){return o.a.createElement(N,Object.assign({key:e._id},e,{calculateData:function(){return a(e._id)}}))}):"No records"))}}]),t}(n.Component),q=Object(c.b)(function(e){var t=e.map;return Object(y.a)({},t)},function(e){return{calculateData:function(t){return e((a=t,function(e,t){e({type:"CALCULATE_DATA"});var r=t().map,n=r.calculatedData,o=r.currentData.find(function(e){return e._id===a}),i=F(JSON.parse(o.data));U.a.isEqual(n,i)?e({type:"CALCULATE_DATA_IS_EQUAL"}):e({type:"CALCULATE_DATA_SUCCESS",payload:Object(y.a)({},i)})}));var a}}})(B),I=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(z,null),o.a.createElement(q,null))};a(295);var W=function(){return o.a.createElement(I,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var H=a(159),J=a(39),Q=a.n(J),G=a(37),K=a(160),X=a.n(K),Y="http://vyboina.tk/api",Z=new(function(){function e(){var t=this;Object(x.a)(this,e),this.sendRequest=function(e,a,r){return t.adapter.request({url:e,method:a.toUpperCase(),data:r}).catch(t.handleApiError)},this.adapter=X.a.create({baseURL:Y})}return Object(g.a)(e,[{key:"handleApiError",value:function(e){return e.response&&e.response.data?Promise.reject(new Error(e.response.data)):Promise.reject(new Error(e.message))}}]),e}()),ee=Q.a.mark(te);function te(){var e,t;return Q.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=function(){var t,a;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(G.b)(Z.sendRequest,"/record","get");case 3:return t=e.sent,a=t.data,e.next=7,Object(G.d)({type:m,payload:a});case 7:e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(0),console.log(e.t0),e.next=14,Object(G.d)({type:f,payload:e.t0});case 14:case"end":return e.stop()}},e,null,[[0,9]])},e=Q.a.mark(t),a.next=4,Object(G.a)([Object(G.e)(b,t)]);case 4:case"end":return a.stop()}},ee)}var ae=Q.a.mark(re);function re(){return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.a)([Object(G.c)(te)]);case 2:case"end":return e.stop()}},ae)}var ne=Object(s.combineReducers)(r),oe=Object(d.a)(),ie=document.getElementById("root"),le=[u.a,oe],ce=Object(s.createStore)(ne,Object(H.composeWithDevTools)(s.applyMiddleware.apply(void 0,le)));oe.run(re),l.a.render(o.a.createElement(c.a,{store:ce},o.a.createElement(W,null)),ie),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},60:function(e){e.exports={version:8,name:"Basic",metadata:{"mapbox:autocomposite":!0},sources:{mapbox:{url:"mapbox://mapbox.mapbox-streets-v7",type:"vector"}},sprite:"mapbox://sprites/mapbox/basic-v8",glyphs:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",layers:[{id:"background",type:"background",paint:{"background-color":"#dedede"},interactive:!0},{id:"landuse_overlay_national_park",type:"fill",source:"mapbox","source-layer":"landuse_overlay",filter:["==","class","national_park"],paint:{"fill-color":"#d2edae","fill-opacity":.75},interactive:!0},{id:"landuse_park",type:"fill",source:"mapbox","source-layer":"landuse",filter:["==","class","park"],paint:{"fill-color":"#d2edae"},interactive:!0},{id:"waterway",type:"line",source:"mapbox","source-layer":"waterway",filter:["all",["==","$type","LineString"],["in","class","river","canal"]],paint:{"line-color":"#a0cfdf","line-width":{base:1.4,stops:[[8,.5],[20,15]]}},interactive:!0},{id:"water",type:"fill",source:"mapbox","source-layer":"water",paint:{"fill-color":"#a0cfdf"},interactive:!0},{id:"building",type:"fill",source:"mapbox","source-layer":"building",paint:{"fill-color":"#d6d6d6"},interactive:!0},{interactive:!0,layout:{"line-cap":"butt","line-join":"miter"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway_link","street","street_limited","service","track","pedestrian","path","link"],["==","structure","tunnel"]]],type:"line",source:"mapbox",id:"tunnel_minor",paint:{"line-color":"#efefef","line-width":{base:1.55,stops:[[4,.25],[20,30]]},"line-dasharray":[.36,.18]},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"butt","line-join":"miter"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway","primary","secondary","tertiary","trunk"],["==","structure","tunnel"]]],type:"line",source:"mapbox",id:"tunnel_major",paint:{"line-color":"#fff","line-width":{base:1.4,stops:[[6,.5],[20,30]]},"line-dasharray":[.28,.14]},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway_link","street","street_limited","service","track","pedestrian","path","link"],["in","structure","none","ford"]]],type:"line",source:"mapbox",id:"road_minor",paint:{"line-color":"#efefef","line-width":{base:1.55,stops:[[4,.25],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway","primary","secondary","tertiary","trunk"],["in","structure","none","ford"]]],type:"line",source:"mapbox",id:"road_major",paint:{"line-color":"#fff","line-width":{base:1.4,stops:[[6,.5],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"butt","line-join":"miter"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway_link","street","street_limited","service","track","pedestrian","path","link"],["==","structure","bridge"]]],type:"line",source:"mapbox",id:"bridge_minor case",paint:{"line-color":"#dedede","line-width":{base:1.6,stops:[[12,.5],[20,10]]},"line-gap-width":{base:1.55,stops:[[4,.25],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"butt","line-join":"miter"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway","primary","secondary","tertiary","trunk"],["==","structure","bridge"]]],type:"line",source:"mapbox",id:"bridge_major case",paint:{"line-color":"#dedede","line-width":{base:1.6,stops:[[12,.5],[20,10]]},"line-gap-width":{base:1.55,stops:[[4,.25],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway_link","street","street_limited","service","track","pedestrian","path","link"],["==","structure","bridge"]]],type:"line",source:"mapbox",id:"bridge_minor",paint:{"line-color":"#efefef","line-width":{base:1.55,stops:[[4,.25],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway","primary","secondary","tertiary","trunk"],["==","structure","bridge"]]],type:"line",source:"mapbox",id:"bridge_major",paint:{"line-color":"#fff","line-width":{base:1.4,stops:[[6,.5],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["<=","admin_level",2],["==","maritime",0]]],type:"line",source:"mapbox",id:"admin_country",paint:{"line-color":"#8b8a8a","line-width":{base:1.3,stops:[[3,.5],[22,15]]}},"source-layer":"admin"},{interactive:!0,minzoom:5,layout:{"icon-image":"{maki}-11","text-offset":[0,.5],"text-field":"{name_en}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-max-width":8,"text-anchor":"top","text-size":11,"icon-size":1},filter:["all",["==","$type","Point"],["all",["==","scalerank",1],["==","localrank",1]]],type:"symbol",source:"mapbox",id:"poi_label",paint:{"text-color":"#666","text-halo-width":1,"text-halo-color":"rgba(255,255,255,0.75)","text-halo-blur":1},"source-layer":"poi_label"},{interactive:!0,layout:{"symbol-placement":"line","text-field":"{name_en}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-transform":"uppercase","text-letter-spacing":.1,"text-size":{base:1.4,stops:[[10,8],[20,14]]}},filter:["all",["==","$type","LineString"],["in","class","motorway","primary","secondary","tertiary","trunk"]],type:"symbol",source:"mapbox",id:"road_major_label",paint:{"text-color":"#666","text-halo-color":"rgba(255,255,255,0.75)","text-halo-width":2},"source-layer":"road_label"},{interactive:!0,minzoom:8,layout:{"text-field":"{name_en}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-max-width":6,"text-size":{stops:[[6,12],[12,16]]}},filter:["all",["==","$type","Point"],["in","type","town","village","hamlet","suburb","neighbourhood","island"]],type:"symbol",source:"mapbox",id:"place_label_other",paint:{"text-color":"#666","text-halo-color":"rgba(255,255,255,0.75)","text-halo-width":1,"text-halo-blur":1},"source-layer":"place_label"},{interactive:!0,layout:{"text-field":"{name_en}","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-max-width":10,"text-size":{stops:[[3,12],[8,16]]}},maxzoom:16,filter:["all",["==","$type","Point"],["==","type","city"]],type:"symbol",source:"mapbox",id:"place_label_city",paint:{"text-color":"#666","text-halo-color":"rgba(255,255,255,0.75)","text-halo-width":1,"text-halo-blur":1},"source-layer":"place_label"},{interactive:!0,layout:{"text-field":"{name_en}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-max-width":10,"text-size":{stops:[[3,14],[8,22]]}},maxzoom:12,filter:["==","$type","Point"],type:"symbol",source:"mapbox",id:"country_label",paint:{"text-color":"#666","text-halo-color":"rgba(255,255,255,0.75)","text-halo-width":1,"text-halo-blur":1},"source-layer":"country_label"}]}}},[[172,1,2]]]);
//# sourceMappingURL=main.5a606e75.chunk.js.map